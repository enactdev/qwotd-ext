function MyExtension() {
	//urlArrays is an array of all the URLs we have visited
    var urlArrays = [];
    var self = this;
    self.refresh();
    kango.ui.browserButton.addEventListener(kango.ui.browserButton.event.COMMAND, function() {
        self._onCommand();
});

	

	kango.browser.addEventListener(kango.browser.event.DOCUMENT_COMPLETE, function(){
		var length = urlArrays.length;
		// output current tab url to console
		kango.browser.tabs.getCurrent(function(tab) {		
       	        // tab is KangoBrowserTab object
        	kango.console.log(tab.getUrl());
		if(!(tab.getUrl().indexOf("chrome")>=0)){
		urlArrays.push(tab.getUrl());
		kango.console.log(urlArrays);}
	});
});
	
   kango.browser.addEventListener(kango.browser.event.TAB_CHANGED,function() {
   	kango.console.log("The tab has changed.");
	kango.browser.tabs.getCurrent(function(tab) {
		kango.console.log("Current tab: ");
		kango.console.log(tab.getUrl());
	});
	
	
});

}

MyExtension.prototype = {
        _refreshTimeout: 60*1000*8,    // 8 minutes
        _feedUrl: 'http://alpha.qwotd.com/api/details/?url=google.com',
        refresh: function() {
                var details = {
                        url: this._feedUrl,
                        method: 'GET',
                        async: false,
                        contentType: 'json'
                };
                var self = this;
                kango.xhr.send(details, function(data) {
                        var info = data.response;
                        kango.console.log(info.url)

                        self._setUnreadCount(info.count);
                });
        },

    _onCommand: function() {
		kango.console.log("Hey there!!!");
		kango.ui.browserButton.setPopup({url:'popup.html', width: 600, height:520});
	}
}

var extension = new MyExtension();
